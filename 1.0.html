<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="https://virtualjs.github.io/Emulator/Windows/Externall%20Styling/IBM_CGA.css"> <!-- Import MxPlus IBM CGA-->
    <style>
        html, body, div, input {
            font-family: "MxPlus IBM CGA";
        }
        /* Output container style */
        #output-container {
            white-space: pre-wrap;
            margin-top: 0;
        }


        /* Make the input container take up the full width */
        #input-container {
            width: 100%;
        }


        /* Style for user input area */
        #userInput {
            display: inline-block;
            min-width: 100%;
            word-wrap: break-word;
        }
.black {
   background-color: black;
   color: white;
}
div[contenteditable="true"] {
    background-color: transparent;
    color: white;
    border: none;
    outline: none;
    padding: 0;
    margin: 0;
    font-family: inherit;
    font-size: inherit;
}


/* Ensure the container aligns properly without visible borders */
#input-container .black div[contenteditable="true"] {
    min-width: 50px;
    display: inline-block;
    vertical-align: middle;
    box-sizing: border-box;
}
    </style>
    <title>MS-DOS 1.0 Emulator</title>
</head>
<body class="black">
    <div class="black">
        MS-DOS Version 1.0<br>
        Copyright (C) Microsoft Corp 1981<br>
    </div>
    <div id="output-container" class="black"></div>
    <div id="input-container">
        <div class="black">
            <span>A:&gt;</span>
            <div contenteditable="true" id="userInput"></div>
        </div>
    </div>
    <script>
    function setFaviconBasedOnTheme() {
        const darkModeFavicon = "https://iili.io/207HCAu.png";
        const lightModeFavicon = "https://iili.io/205OIEP.png";
        const isDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
       
        const favicon = document.getElementById('favicon');
       
        if (isDarkMode) {
            favicon.href = darkModeFavicon;
        } else {
            favicon.href = lightModeFavicon;
        }
    }
   
    setFaviconBasedOnTheme();
    window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', setFaviconBasedOnTheme);


    const userInput = document.getElementById("userInput");
    const outputContainer = document.getElementById("output-container");


    let inFileCreation = false;
    let currentFileName = '';
    let currentFileType = '';


    // Save files to localStorage
    function saveFiles() {
        localStorage.setItem("files", JSON.stringify(files));
    }


    // Function to move cursor to the far right after every input
    function moveCursorToEnd() {
        const range = document.createRange();
        const selection = window.getSelection();
        range.selectNodeContents(userInput);
        range.collapse(false);
        selection.removeAllRanges();
        selection.addRange(range);
    }


    // Convert input to uppercase as user types
    userInput.addEventListener('input', function() {
        userInput.innerText = userInput.innerText.toUpperCase();
        moveCursorToEnd();
    });


    // Respond to user input in IO.SYS
    function respondToInput() {
        userInput.addEventListener('keydown', function(event) {
            if ((event.ctrlKey || event.metaKey) && event.key === "z") {
                event.preventDefault();
                const cursorPosition = userInput.selectionStart;
                const currentText = userInput.innerText;
                const newText = currentText.slice(0, cursorPosition) + '^Z' + currentText.slice(cursorPosition);
                userInput.innerText = newText;
                userInput.selectionStart = userInput.selectionEnd = cursorPosition + 3;
                moveCursorToEnd();
            } else if (event.key === "Backspace" || event.key === "Delete") {
                const cursorPosition = userInput.selectionStart;
                const currentText = userInput.innerText;
                if (cursorPosition < currentText.length && currentText.slice(cursorPosition, cursorPosition + 2) === "^Z") {
                    event.preventDefault();
                    const newText = currentText.slice(0, cursorPosition) + currentText.slice(cursorPosition + 2);
                    userInput.innerText = newText;
                    userInput.selectionStart = userInput.selectionEnd = cursorPosition;
                    moveCursorToEnd();
                }
                else if (cursorPosition >= 2 && currentText.slice(cursorPosition - 2, cursorPosition) === "^Z") {
                    event.preventDefault();
                    const newText = currentText.slice(0, cursorPosition - 2) + currentText.slice(cursorPosition);
                    userInput.innerText = newText;
                    userInput.selectionStart = userInput.selectionEnd = cursorPosition - 2;
                    moveCursorToEnd();
                }
            } else if (event.key === "Enter") {
                let inputText = userInput.innerText.trim();
                let commandOutput = '';


                if (inputText === "DIR") {
                    commandOutput = [
                        "Directory of A:\\",
                        ...files.map(file => file.filename)
                    ].join("\n");
                }
                
                else if (inputText.startsWith("DEL ")) {
                    let fileName = inputText.slice(4).trim();
                    let fileIndex = files.findIndex(file => file.filename === fileName);
                    if (fileIndex !== -1) {
                        files.splice(fileIndex, 1); // Remove the file from the array
                        saveFiles(); // Save updated files to localStorage
                        commandOutput = `File ${fileName} deleted.`;
                    } else {
                        commandOutput = "Bad command or file name";
                    }
                }
                else if (inputText.startsWith("REN ")) {
                    let parts = inputText.slice(4).trim().split(" ");
                    if (parts.length === 2) {
                        let oldFileName = parts[0];
                        let newFileName = parts[1];
                        let file = files.find(file => file.filename === oldFileName);
                        if (file) {
                            file.filename = newFileName;
                            saveFiles(); // Save updated files to localStorage
                        } else {
                            commandOutput = "Bad command or file name";
                        }
                    } else {
                        commandOutput = "Bad command or file name";
                    }
                }
                else if (inputText.startsWith("TYPE ")) {
                    let fileName = inputText.slice(5).trim();
                    let file = files.find(file => file.filename === fileName);
                    if (file) {
                        commandOutput = file.content;
                    } else {
                        commandOutput = "Bad command or file name";
                    }
                }
                else if (inputText.trim() === "") {
                } else {
                    commandOutput = "Bad command or file name";
                }


                // Output the command and result
                if (inputText.trim() === "" || inputText.startsWith("REN ")) {
                    outputContainer.textContent += `A:> ${inputText}\n`;
                } else {
                    outputContainer.textContent += `A:> ${inputText}\n${commandOutput}\n`;
                }


                // Clear input and move cursor to end
                userInput.innerText = '';
                moveCursorToEnd();
                event.preventDefault();
            }
        });
    }


let files = JSON.parse(localStorage.getItem("files")) || [ 
    {"filename": "MSDOS", "extension": "SYS", "content": "B400CD16B40EB041CD10B44BB0008D160000CD21B44CB001CD21B40EB042CD10B400CD16B40EB043CD10B44BB0008D160001CD21B44CB001CD21B40EB044CD10B400CD16B40EB045CD10B44BB0008D160002CD21B44CB001CD21B40EB046CD10B400CD16B40EB047CD10B44BB0008D160003CD21B44CB001CD21B40EB048CD10B400CD16B40EB049CD10B44BB0008D160004CD21B44CB001CD21B40EB04ACD10B400CD16B40EB04BCD10B44BB0008D160005CD21B44CB001CD21B40EB04CCD10B400CD16B40EB04DCD10B44BB0008D160006CD21B44CB001CD21B40EB04ECD10B400CD16B40EB04FCD10B44BB0008D160007CD21B44CB001CD21B40EB050CD10B400CD16B40EB051CD10B44BB0008D160008CD21B44CB001CD21B40EB052CD10B400CD16B40EB053CD10B44BB0008D160009CD21B44CB001CD21B40EB054CD10B400CD16B40EB055CD10B44BB0008D16000ACD21B44CB001CD21B40EB056CD10B400CD16B40EB057CD10B44BB0008D16000BCD21B44CB001CD21B40EB058CD10B400CD16B40EB059CD10B44BB0008D16000CCD21B44CB001CD21B40EB05ACD10B400CD16B40EB05BCD10B44BB0008D16000DCD21B44CB001CD21B40EB05CCD10B400CD16B40EB05DCD10B44BB0008D16000ECD21B44CB001CD21B40EB05ECD10B400CD16B40EB05FCD10B44BB0008D16000FCD21B44CB001CD21B40EB060CD10B400CD16B40EB061CD10B44BB0008D160010CD21B44CB001CD21B40EB062CD10B400CD16B40EB063CD10B44BB0008D160011CD21B44CB001CD21B40EB064CD10B400CD16B40EB065CD10B44BB0008D160012CD21B44CB001CD21B40EB066CD10B400CD16B40EB067CD10B44BB0008D160013CD21B44CB001CD21B40EB068CD10B400CD16B40EB069CD10B44BB0008D160014CD21B44CB001CD21B40EB06ACD10B400CD16B40EB06BCD10B44BB0008D160015CD21B44CB001CD21B40EB06CCD10B400CD16B40EB06DCD10B44BB0008D160016CD21B44CB001CD21B40EB06ECD10B400CD16B40EB06FCD10B44BB0008D160017CD21B44CB001CD21B40EB070CD10B400CD16B40EB071CD10B44BB0008D160018CD21B44CB001CD21B40EB072CD10B400CD16B40EB073CD10B44BB0008D160019CD21B44CB001CD21B40EB074CD10B400CD16B40EB075CD10B44BB0008D16001ACD21B44CB001CD21B40EB076CD10B400CD16B40EB077CD10B44BB0008D16001BCD21B44CB001CD21B40EB078CD10B400CD16B40EB079CD10B44BB0008D16001CCD21B44CB001CD21B40EB07ACD10B400CD16B40EB07BCD10B44BB0008D16001DCD21B44CB001CD21B40EB07CCD1066BB0018", "date-of-creation": "08-12-81"},
    {"filename": "IO", "extension": "SYS", "content": "B802008B01008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B80000E81600F4B80000E81000F4668936007DE80C008ED88EF08EE28CC08BC3CD137226E81C00B8", "date-of-creation": "08-12-81"},
    {"filename": "COMMAND", "extension": "COM", "content": "B400CD16B40EB041CD10B44BB0008D160000CD21B44CB001CD21B40EB042CD10B400CD16B40EB043CD10B44BB0008D160001CD21B44CB001CD21B40EB044CD10B400CD16B40EB045CD10B44BB0008D160002CD21B44CB001CD21B40EB046CD10B400CD16B40EB047CD10B44BB0008D160003CD21B44CB001CD21B40EB048CD10B400CD16B40EB049CD10B44BB0008D160004CD21B44CB001CD21B40EB04ACD10B400CD16B40EB04BCD10B44BB0008D160005CD21B44CB001CD21B40EB04CCD10B400CD16B40EB04DCD10B44BB0008D160006CD21B44CB001CD21B40EB04ECD10B400CD16B40EB04FCD10B44BB0008D160007CD21B44CB001CD21B40EB050CD10B400CD16B40EB051CD10B44BB0008D160008CD21B44CB001CD21B40EB052CD10B400CD16B40EB053CD10B44BB0008D160009CD21B44CB001CD21B40EB054CD10B400CD16B40EB055CD10B44BB0008D16000ACD21B44CB001CD21B40EB056CD10B400CD16B40EB057CD10B44BB0008D16000BCD21B44CB001CD21B40EB058CD10B400CD16B40EB059CD10B44BB0008D16000CCD21B44CB001CD21B40EB05ACD10B400CD16B40EB05BCD10B44BB0008D16000DCD21B44CB001CD21B40EB05CCD10B400CD16B40EB05DCD10B44BB0008D16000ECD21B44CB001CD21B40EB05ECD10B400CD16B40EB05FCD10B44BB0008D16000FCD21B44CB001CD21B40EB060CD10B400CD16B40EB061CD10B44BB0008D160010CD21B44CB001CD21B40EB062CD10B400CD16B40EB063CD10B44BB0008D160011CD21B44CB001CD21B40EB064CD10B400CD16B40EB065CD10B44BB0008D160012CD21B44CB001CD21B40EB066CD10B400CD16B40EB067CD10B44BB0008D160013CD21B44CB001CD21B40EB068CD10B400CD16B40EB069CD10B44BB0008D160014CD21B44CB001CD21B40EB06ACD10B400CD16B40EB06BCD10B44BB0008D160015CD21B44CB001CD21B40EB06CCD10B400CD16B40EB06DCD10B44BB0008D160016CD21B44CB001CD21B40EB06ECD10B400CD16B40EB06FCD10B44BB0008D160017CD21B44CB001CD21B40EB070CD10B400CD16B40EB071CD10B44BB0008D160018CD21B44CB001CD21B40EB072CD10B400CD16B40EB073CD10B44BB0008D160019CD21B44CB001CD21B40EB074CD10B400CD16B40EB075CD10B44BB0008D16001ACD21B44CB001CD21B40EB076CD10B400CD16B40EB077CD10B44BB0008D16001BCD21B44CB001CD21B40EB078CD10B400CD16B40EB079CD10B44BB0008D16001CCD21B44CB001CD21B40EB07ACD10B400CD16B40EB07BCD10B44BB0008D16001DCD21B44CB001CD21B40EB07CCD10B400CD16B40EB07DCD10B44BB0008D16001ECD21B44CB001CD21B40EB07ECD10B400CD16B40EB07FCD10B44BB0008D16001FCD21B44CB001CD21B40EB080CD10B400CD16B40EB081CD10B44BB0008D160020CD21B44CB001CD21B40EB082CD10B400CD16B40EB083CD10B44BB0008D160021CD21B44CB001CD21B40EB084CD10B400CD16B40EB085CD10B44BB0008D160022CD21B44CB001CD21B40EB086CD10B400CD16B40EB087CD10B44BB0008D160023CD21B44CB001CD21B40EB088CD10B400CD16B40EB089CD10B44BB0008D160024CD21B44CB001CD21B40EB08ACD10B400CD16B40EB08BCD10B44BB0008D160025CD21B44CB001CD21B40EB08CCD10B400CD16B40EB08DCD10B44BB0008D160026CD21B44CB001CD21B40EB08ECD10B400CD16B40EB08FCD10B44BB0008D160027CD21B44CB001CD21B40EB090CD10B400CD16B40EB091CD10B44BB0008D160028CD21B44CB001CD21B40EB092CD10B400CD16B40EB093CD10B44BB0008D160029CD21B44CB001CD21B40EB094CD10B400CD16B40EB095CD10B44BB0008D16002ACD21B44CB001CD21B40EB096CD10B400CD16B40EB097CD10B44BB0008D16002BCD21B44CB001CD21B40EB098CD10B400CD16B40EB099CD10B44BB0008D16002CCD21B44CB001CD21B40EB09ACD10B400CD16B40EB09BCD10B44BB0008D16002DCD21B44CB001CD21B40EB09CCD10B400CD16B40EB09DCD10B44BB0008D16002ECD21B44CB001CD21B40EB09FCD10B400CD16B40EB0A0CD10B44BB0008D16002FCD21B44CB001CD21B40EB0A1CD10B400CD16B40EB0A2CD10B44BB0008D160030CD21B44CB001CD21B40EB0A3CD10B400CD16B40EB0A4CD10B44BB0008D160031CD21B44CB001CD21B40EB0A5CD10B400CD16B40EB0A6CD10B44BB0008D1", "date-of-creation": "08-12-81"},
    {"filename": "CHKDSK", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "SYS", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DISKCOPY", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DISKCOMP", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "COMP", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DATE", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "TIME", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "MODE", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "EDLIN", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DEBUG", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "LINK", "extension": "EXE", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "BASIC", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "BASICA", "extension": "COM", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "ART", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "SAMPLES", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "MORTGAGE", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "COLORBAR", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "BUG", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "CALENDER", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "MUSIC", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DONKEY", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "BLUE", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "HUMOR", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "POP", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "FORTY", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "DANDY", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "MARCH", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "STARS", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "HAT", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "SCALES", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "SAKURA", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "CIRCLE", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "PIECHART", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "SPACE", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "BALL", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
    {"filename": "COMM", "extension": "BAS", "content": "<system-code-placeholder>", "date-of-creation": "08-12-81"},
];

respondToInput();
saveFiles();
moveCursorToEnd();
    </script>
</body>
</html>